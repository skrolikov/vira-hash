# Vira Hash

Пакет `vira-hash` предоставляет простые и безопасные функции для хеширования и проверки паролей с использованием алгоритма bcrypt.

## Особенности

- Использует стандартную библиотеку `golang.org/x/crypto/bcrypt`
- Простой интерфейс с двумя основными функциями
- Автоматически использует оптимальную стоимость хеширования (bcrypt.DefaultCost)
- Безопасное сравнение паролей с защитой от timing-атак

## Установка

```bash
go get github.com/yourusername/vira-hash
```

## Использование

### Хеширование пароля

```go
import "github.com/yourusername/vira-hash/hash"

func main() {
    password := "user_password123"
    
    hashedPassword, err := hash.HashPassword(password)
    if err != nil {
        // Обработка ошибки
    }
    
    // Сохраните hashedPassword в вашей базе данных
}
```

### Проверка пароля

```go
import "github.com/yourusername/vira-hash/hash"

func main() {
    storedHash := "$2a$10$N9qo8uLOickgx2ZMRZoMy..." // Хеш из базы данных
    userInput := "user_password123"
    
    if hash.CheckPasswordHash(storedHash, userInput) {
        // Пароль верный
    } else {
        // Пароль неверный
    }
}
```

## Настройка

По умолчанию используется стоимость хеширования `bcrypt.DefaultCost` (в настоящее время 10). Если вам нужно изменить это значение, вы можете модифицировать константу `Cost` в коде пакета:

```go
const Cost = 12 // Более высокая стоимость = более безопасно, но медленнее
```

## Безопасность

- Все пароли хешируются с добавлением случайной соли (salt)
- Встроенная защита от timing-атак при сравнении паролей
- Используется проверенный алгоритм bcrypt

## Ошибки

Функция `HashPassword` возвращает ошибку в случае:
- Проблем с генерацией случайных чисел
- Недостаточной памяти
- Некорректной стоимости хеширования (слишком большой или маленькой)